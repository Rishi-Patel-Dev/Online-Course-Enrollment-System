-- View 1: Course availability summary
CREATE VIEW Course_Availability AS
SELECT 
    C.course_id,
    C.title,
    C.department,
    C.max_capacity,
    C.current_enrollment,
    C.max_capacity - C.current_enrollment AS seats_available,
    COUNT(W.waitlist_id) AS waitlist_count
FROM Course C
LEFT JOIN Waitlist W ON C.course_id = W.course_id
GROUP BY C.course_id, C.title, C.department, C.max_capacity, C.current_enrollment;

-- View 2: Student enrollment details
CREATE VIEW Student_Enrollments AS
SELECT 
    S.student_id,
    S.name,
    S.email,
    C.course_id,
    C.title,
    C.credits,
    E.status,
    E.enrollment_date
FROM Student S
JOIN Enrollment E ON S.student_id = E.student_id
JOIN Course C ON E.course_id = C.course_id
WHERE E.status = 'active';

-- View 3: Waitlist with position information
CREATE VIEW Waitlist_Status AS
SELECT 
    W.waitlist_id,
    S.student_id,
    S.name,
    S.email,
    C.course_id,
    C.title,
    W.position,
    W.join_date,
    C.max_capacity - C.current_enrollment AS seats_until_enrolled
FROM Waitlist W
JOIN Student S ON W.student_id = S.student_id
JOIN Course C ON W.course_id = C.course_id
ORDER BY W.course_id, W.position;
